#!/bin/bash

if [ $1 == "shot" ]; then
    btrfs subvolume snapshot -r /media/Vault/Documentos /media/Vault/.snapshots/@$(date "+%Y-%m-%d")
fi

if [ $1 == "send" ]; then
    echo "Choose old snapshot for incrementation against recent snapshot:"
    OLDSNAPSHOT=$(ls /media/Vault/.snapshots | fzf)
    sudo btrfs send -p /media/Vault/.snapshots/$OLDSNAPSHOT /media/Vault/.snapshots/@$(date "+%Y-%m-%d") | sudo btrfs receive /media/Andromeda/
fi

if [ $1 == "now" ]; then
    btrfs subvolume snapshot -r /media/Vault/Documentos /media/Vault/.snapshots/@$(date "+%Y-%m-%d")
    sudo btrfs send -p /media/Vault/.snapshots/$2 .snapshots/@$(date "+%Y-%m-%d") | sudo btrfs receive /media/Andromeda/
fi
