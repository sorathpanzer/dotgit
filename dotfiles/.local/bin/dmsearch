#!/usr/bin/dash

duck_search="https://duckduckgo.com/?q="
google_search="https://www.google.com/search?q="
youtube_search="https://www.youtube.com/results?search_query="
wiki_search="https://en.wikipedia.org/w/index.php?search="
archpkg="https://archlinux.org/packages/?sort=&q="
archwiki="https://wiki.archlinux.org/index.php?search="
github="https://github.com/search?q="
odysee="https://odysee.com/$/search?q="
stackoverflow="https://stackoverflow.com/search?q="
translate="https://translate.google.com/?sl=auto&tl=en&text="

options=$(echo "duckduckgo google youtube github translate archpkg archwiki wikipedia odysee" | tr ' ' '\n')
search_engine=$(printf '%s\n' "$options" | dmenu -fn "UbuntuMono Nerd Font:size=10" -nf "#cccccc" -nb "#292d3e" -sb "#74438e" -sf "#a5bdf7" -l 20 -p 'Choose search engine:') "$@" || exit
keyword=$(tac ~/.cache/search_history | dmenu -fn "UbuntuMono Nerd Font:size=10" -nf "#cccccc" -nb "#292d3e" -sb "#74438e" -sf "#a5bdf7" -l 1 -p "Search")

[ "$keyword" = "" ] || echo $keyword >> ~/.cache/search_history

search_word=${keyword#$search_engine}

case $search_engine in
	"duckduckgo") $BROWSER "$duck_search$search_word" ;;
	"google") $BROWSER "$google_search$search_word" ;;
	"youtube") $BROWSER "$youtube_search$search_word" ;;
	"wikipedia") $BROWSER "$wiki_search$search_word" ;;
	"archpkg") $BROWSER "$archpkg$search_word" ;;
	"archwiki") $BROWSER "$archpkg$search_word" ;;
	"github") $BROWSER "$github$search_word" ;;
	"odysee") $BROWSER "$odysee$search_word" ;;
	"stackoverflow") $BROWSER "$stackoverflow$search_word" ;;
	"translate") $BROWSER "$translate$search_word" ;;
esac
