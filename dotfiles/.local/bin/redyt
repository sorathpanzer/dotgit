#!/bin/sh

cachedir=$HOME/.cache/redyt
limit=100

subreddit=$(cat ~/.config/redyt/subreddit.txt | fzf)
curl -H "User-agent: 'your bot 0.1'" https://www.reddit.com/r/$subreddit/hot.json?limit=$limit > $cachedir/tmp.json &&
imgs=$(cat $cachedir/tmp.json | jq '.' | grep url_overridden_by_dest | grep -Eo "https://.*(gif|jpg|png)\b")

wget -P $cachedir $imgs

sxiv -a $cachedir/*png $cachedir/*jpg $cachedir/*gif

rm $cachedir/*jpg
rm $cachedir/*png
rm $cachedir/*gif
rm $cachedir/*json
rm $cachedir/*.1
