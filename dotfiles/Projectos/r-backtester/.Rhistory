listLong <- txsClosed[txsClosed$Txn.Qty == pos & txsClosed$Net.Txn.Realized.PL >= 0, ]
cumsum(listLong["Net.Txn.Realized.PL"])
}
orders <- as.data.frame(getOrders(portfolio.st, symbols, status = "closed"))
ordersCols <- orders[,c("Order.Qty", "Order.Price",	"Order.Type",	"Order.Side",	"Order.Threshold",	"Order.Status", "Order.StatusTime",	"Order.Set",	"Rule",	"Time.In.Force")]
tbind <- cbind(txs, ordersCols)
startOrders <- tbind[ c(TRUE,FALSE), ]
endOrders <- tbind[ c(FALSE,TRUE), ]
sID <- startOrders[,c("Txn.Price","Order.Side","Rule")]
startOrdersFilter <- cbind(sID, "ID"=1:nrow(sID))
eID <- endOrders[,c("Txn.Price","Rule")] %>%
rename(
"Txn.Price.Close" = Txn.Price,
"Rule.Close" = Rule)
endOrdersFilter <- cbind(eID, "ID"=1:nrow(eID))
bindThem <- merge(data.frame(startOrdersFilter, row.names=NULL), data.frame(endOrdersFilter, row.names=NULL), by = "ID", all = TRUE)[-1]
cleanThem <- bindThem[!is.na(bindThem$Rule.Close),]
tradeStats <- perTradeStats(portfolio.st, symbols, includeOpenTrade = FALSE)
tradeStatsFilter <- tradeStats[,c("Start", "End","Net.Trading.PL", "Pct.Net.Trading.PL", "duration")]
tradeStatsMerge <- cbind(tradeStatsFilter,cleanThem)
tradeStatsOrder <- tradeStatsMerge[,c("Start", "End", "Order.Side", "Txn.Price", "Rule", "Net.Trading.PL",	"Pct.Net.Trading.PL", "Txn.Price.Close", "Rule.Close", "duration")] %>%
rename(
Position = Order.Side,
"Entry.Price" = Txn.Price,
"Entry.Rule" = Rule,
"PL" = Net.Trading.PL,
"PL (%)" = Pct.Net.Trading.PL,
"Close.Price" = Txn.Price.Close,
"Close Rule" = Rule.Close,
"Duration" = duration)
arTab <- table.AnnualizedReturns(rets)
max.risk <- max(arTab["Annualized Std Dev",])
max.return <- max(arTab["Annualized Return",])
a <- getAccount(account.st)
equity = a$summary$End.Eq[start_date]
chart.Posn(portfolio.st, Symbol = symbols)
quanTiles <- tradeQuantiles(portfolio.st, symbols, scale = c("cash", "percent", "tick"),
probs = c(0.5, 0.75, 0.9, 1))
chart.ME(Portfolio=portfolio.st, Symbol=symbols, type='MAE', scale='cash')
chart.ME(Portfolio=portfolio.st, Symbol=symbols, type='MFE', scale='cash')
chart.Boxplot(rets, main = "EURUSD Returns", colorset= rich10equal)
charts.PerformanceSummary(apply.monthly(rets, Return.cumulative),
colorset = bluefocus, main = "Strategy Performance")
chart.RiskReturnScatter(rets,
main = "EURUSD Performance", colorset = rich10equal,
xlim = c(0, max.risk * 1.1), ylim = c(0, max.return))
chart.RiskReturnScatter(rets, Rf = 0, add.sharpe = c(1, 2),
main = "Return vs. Risk", colorset = c("red", "blue"))
quanTiles <- tradeQuantiles(portfolio.st, symbols, scale = c("cash", "percent", "tick"),
probs = c(0.5, 0.75, 0.9, 1))
hchart(equity, color = "black", name = "PL") %>%
hc_title(text = "Equity")
tradeStatsOrder$weekday <- wday(tradeStatsOrder[,1])
tradeStatsOrder
monday <- filter(tradeStatsOrder, weekday == '1')
sum(monday$PL)
source("highchart.R")
chartplot
kable(t(dailyStats(portfolio.st)))
kable(t(tradeStats(portfolio.st)))
kable(LS_Stats("long"))
kable(LS_Stats("short"))
yearlyReturn(equity) * 200
t2 <- Sys.time()
print(t2-t1)
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2019-01-02")
STOCK <- IRBT
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
ST100 <- STOCK/100
SP100 <- SPY/100
COMP <- (ST100+SP100)
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2019-01-02")
STOCK <- IRBT
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
ST100 <- STOCK/100
SP100 <- SPY/100
COMP <- (ST100-SP100)
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2019-01-02")
STOCK <- IRBT
getSymbols(STOCK, src = "yahoo")
getSymbols("SPY", src = "yahoo")
ST100 <- STOCK/100
SP100 <- SPY/100
COMP <- (ST100-SP100)
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
STOCK <- IRBT
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
ST100 <- IRBT/100
SP100 <- SPY/100
COMP <- (ST100-SP100)
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
ST100 <- IRBT
SP100 <- SPY
COMP <- (ST100-SP100)
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
ST100 <- IRBT
SP100 <- SPY
COMP <- (ST100-SP100)/100
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
IRBTSPY <- IRBT+SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(IRBTSPY, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
IRBTSPY <- IRBT-SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(IRBTSPY, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
getSymbols("IRBT", src = "yahoo")
getSymbols("SPY", src = "yahoo")
IRBTSPY <- IRBT+SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(IRBTSPY, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007::")
STOCK <- IRBT
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- IRBT/SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2008::")
STOCK <- IRBT
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- IRBT/SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
STOCK <- IRBT
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- IRBT/SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- IRBT/SPY
candleChart(IRBT, up.col = "green", dn.col = "red", theme = "black")
#candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
STOCK <- IRBT
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
#candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
STOCK <- IRBT
STOCK = IRBT
getSymbols("IRBT", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
#candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
STOCK <- IRBT
STOCK = IRBT
getSymbols("STOCK", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
#candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
STOCK <- IRBT
STOCK = IRBT
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
#candleChart(SPY, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
#dataEnv<-new.env()
STOCK <- c("IRBT")
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
getSymbols(STOCK, src = "yahoo", from = start_date)
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
#dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c("STOCK")
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
#dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c(STOCK)
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
dataEnv<-new.env()
STOCK <- c("IRBT")
getSymbols(STOCK, env=dataEnv, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
dataEnv<-new.env()
STOCK <- "IRBT"
getSymbols(STOCK, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2007-01-03")
dataEnv<-new.env()
SYMBOL <- c("IRBT")
STOCK <- IRBT
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("IRBT")
STOCK <- IRBT
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("IRBT")
STOCK <- IRBT
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
STOCK <- NVDA
getSymbols("NVDA", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
lenght(SYMBOLS)
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
lenght(SYMBOLS)
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
length(SYMBOLS)
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
length(SYMBOLS)
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("NVDA")
length(SYMBOL)
STOCK <- NVDA
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
SYMBOL <- c("IRBT")
length(SYMBOL)
STOCK <- IRBT
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c("IRBT")
length(SYMBOL)
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c("STOCK")
length(SYMBOL)
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c(STOCK)
length(SYMBOL)
getSymbols(SYMBOL, src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
library(quantmod)
library(ggplot2)
library(magrittr)
library(PerformanceAnalytics)
start_date <- as.Date("2020-01-03")
dataEnv<-new.env()
STOCK <- IRBT
SYMBOL <- c(STOCK)
length(SYMBOL)
getSymbols("SYMBOL", src = "yahoo", from = start_date)
getSymbols("SPY", src = "yahoo", from = start_date)
COMP <- STOCK/SPY
candleChart(STOCK, up.col = "green", dn.col = "red", theme = "black")
candleChart(COMP, up.col = "green", dn.col = "red", theme = "black")
